<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Swagger Navigation</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    </head>
    <body>
        <main class="container">
            <header class="jumbotron alert alert-info">
                <h1>Swagger Navigation</h1>
            </header>

            <form class="well">
                <fieldset>
                    <legend class="col-md-9 col-md-offset-2">Add a Menu Item</legend>

                    <p class="col-md-7 col-md-offset-2">
                        Use a tool like <a href="http://www.getpostman.com/">Postman</a> or <a href="http://curl.haxx.se/">curl</a>
                        to perform more advanced operations.  See <a href="api-docs/PetStore.yaml">the full Swagger API</a>
                        for all the operations available. And be sure to <a href="pets?type=dog">try</a>
                        <a href="pets?tags=furry&tags=brown">a</a> <a href="pets?vet.address.state=CA">few</a>
                        <a href="pets?type=dog&tags=big&vet.address.city=San%20Francisco">queries</a>.
                    </p>

                    <div class="col-md-7 col-md-offset-2">
                        <div class="form-group">
                            <textarea id="pet" name="pet" cols="60" rows="15" class="form-control"
                                      onkeydown="updateUI()" onkeyup="updateUI()" onchange="updateUI()">{
    "title": "Promocodes",
    "link": "/promocodes",
    "icon": "zmdi-card-giftcard",
    "subItems": []
} 
                           </textarea>
                        </div>
                    </div>
                    <p>
                        <span class="col-xs-6 col-sm-4 col-md-2">
                            <button type="button" class="btn btn-success btn-block" onclick="saveNavItem()">
                                <i class="glyphicon glyphicon-ok"></i>
                                Save <span class="pet-label">Nav Item</span>
                            </button>
                            &nbsp;
                        </span>
                        <span class="col-xs-6 col-xs-offset-3 col-sm-4 col-sm-offset-0 col-md-2">
                            <a href="navigation" class="btn btn-default btn-block">
                                <i class="glyphicon glyphicon-list"></i>
                                All Nav Items
                            </a>
                        </span>
                    </p>
                </fieldset>
            </form>
        </main>

        <article id="results-modal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <header class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                        <h4 class="modal-title">Results</h4>
                    </header>
                    <iframe id="results" name="results" seamless class="modal-body" style="width: 100%; border: none"></iframe>
                </div>
            </div>
        </article>

        <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
        <script>
            var navItem;

            function saveNavItem() {
                parseNavItem() && $.ajax({
                    type: 'POST',
                    url: 'navigation',
                    data: $('#pet').val(),
                    contentType: 'application/json',
                    dataType: 'text'
                }).always(showModal);
            }

            function updateUI() {
                parseNavItem();
                if (navItem) {
                    $('.pet-label').text(navItem.title);
                    $('.btn').removeAttr('disabled');
                }
                else {
                    $('.pet-label').text('Nav Item');
                    $('.btn').attr('disabled', 'disabled');
                }
            }

            function parseNavItem() {
                try {
                    return navItem = JSON.parse($('#pet').val());
                }
                catch (e) {
                    navItem = null;
                }
            }

            function showModal(data) {
                data = data.responseText || data || '&lt;&lt; empty response &gt;&gt;';
                $('#results-modal').modal();
                $('#results').contents().find('body').html(data);
            }
        </script>
    </body>
</html>
